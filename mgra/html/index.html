<html><head><title>MGRA</title>
<style type="text/css">
<!--/* <![CDATA[ */
b.hl {
	background-color: #ffff00;
	font-weight: normal;
}
textarea, input, select {
       font-family: Courier New;
}
body {
       font-family: Arial, Helvetica;
}
h2 {
       margin-top: 6pt;
       margin-bottom: 2pt;
}
div.mgrtree a {
       text-decoration: none
}
div.mgrtree pre {
       font-family: Courier New;
}
/* ]]> */-->
</style>
    <script type="text/javascript">
        var genomeCount = 0;

        function addGenome() {
            genomeCount++;
            var table = document.getElementById("genomes");
            var row = table.insertRow(genomeCount - 1);
            row.align = "left";
            row.vAlign = "top";
            var c = [];
            for (var j = 0; 1 > j; j++) {
                c[j] = row.insertCell(j);
                c[j].align = "left";
                c[j].vAlign = "top";
            }

            c[0].innerHTML =
                "<div><strong>Genome " + genomeCount + "</strong></div>" +
                "<div>Name: <input size='1' id='name" + genomeCount + "' name='name" + genomeCount + "'> Aliases <input id='alias" + genomeCount + "'size='25' name='alias" + genomeCount + "'></div>"+
                "<textarea id='genome" + genomeCount + "' name='genome" + genomeCount + "' rows='4' cols='60'></textarea>";
        }


        function initGenomes(n) {
            var table = document.getElementById("genomes");
            for(var i = table.rows.length - 1; i >= 0; i--) {
                table.deleteRow(i);
            }
            genomeCount = 0;
            for (var i = 0; i < n; i++) {
                addGenome();
            }
        }

        function loadFile(file) {
            var X = new XMLHttpRequest();
            X.open('GET', file, false );
            X.setRequestHeader('Content-Type', 'text/html')
            X.send('');
            return X.responseText;
        }

        function setMam6() {
            initGenomes(6);

            document.getElementById("genome1").value = loadFile('blocks6.txt');
            document.getElementById("name1").value = 'M';
            document.getElementById("name2").value = 'R';
            document.getElementById("name3").value = 'D';
            document.getElementById("name4").value = 'Q';
            document.getElementById("name5").value = 'H';
            document.getElementById("name6").value = 'C';

            document.getElementById("alias1").value = 'mouse mm9';
            document.getElementById("alias2").value = 'rat rn4';
            document.getElementById("alias3").value = 'dog canFam2';
            document.getElementById("alias4").value = 'macaque rheMac2';
            document.getElementById("alias5").value = 'human hg18';
            document.getElementById("alias6").value = 'chimpanzee panTro2';
            document.getElementById("trees").value = '(((M,R),D),(Q,(H,C)))';
            document.getElementById("stages").value = '4';
            document.getElementById("target").value = '';
            document.getElementById("completion").value = '1299h 1300h 1300t 1301t R\r'+
                                                            '1289h 1290h 1290t 1291t D\r'+
                                                            '374t 376t oo 375h R\r'+
                                                            '927t 610h 610t 609h R\r'+
                                                            '79h 81t 80t 83h Q\r'+
                                                            '81t 83h 80h 84t Q\r'+
                                                            '794h 795t 795h 796t Q\r'+
                                                            '1196h 1198h 1202t 1199t D\r';
            showTarget(true);
        }

        function setMam7() {
            initGenomes(7);

            document.getElementById("genome1").value = loadFile('blocks7.txt');
            document.getElementById("name1").value = 'M';
            document.getElementById("name2").value = 'R';
            document.getElementById("name3").value = 'D';
            document.getElementById("name4").value = 'Q';
            document.getElementById("name5").value = 'H';
            document.getElementById("name6").value = 'C';
            document.getElementById("name7").value = 'O';

            document.getElementById("alias1").value = 'mouse mm9';
            document.getElementById("alias2").value = 'rat rn4';
            document.getElementById("alias3").value = 'dog canFam2';
            document.getElementById("alias4").value = 'macaque rheMac2';
            document.getElementById("alias5").value = 'human hg18';
            document.getElementById("alias6").value = 'chimpanzee panTro2';
            document.getElementById("alias7").value = 'opossum monDom4';

            document.getElementById("trees").value = '((M,R),DOQHC)\n' +
                                                     '(MRDO,(Q,(H,C)))';

            document.getElementById("stages").value = '3';
            document.getElementById("target").value = '';
            document.getElementById("completion").value = '';
            showTarget(false);
        }

        function setMurphy05() {
            initGenomes(7);


            document.getElementById("genome1").value = loadFile('murphy05.txt');

            document.getElementById("name1").value = 'H';
            document.getElementById("name2").value = 'R';
            document.getElementById("name3").value = 'M';
            document.getElementById("name4").value = 'D';
            document.getElementById("name5").value = 'C';
            document.getElementById("name6").value = 'P';
            document.getElementById("name7").value = 'W';

            document.getElementById("alias1").value = 'human';
            document.getElementById("alias2").value = 'rat';
            document.getElementById("alias3").value = 'mouse';
            document.getElementById("alias4").value = 'dog';
            document.getElementById("alias5").value = 'cat';
            document.getElementById("alias6").value = 'pig';
            document.getElementById("alias7").value = 'cattle';

            document.getElementById("trees").value = '((H,(M,R)),DCPW)\n'+
                                                     '((D,C),HRMPW)\n' +
                                                     '((P,W),HRMDC)';

            document.getElementById("stages").value = '3';
            document.getElementById("target").value = 'DCPW';
            document.getElementById("completion").value = '';
            showTarget(true);
        }

        function setToy05() {
            initGenomes(4);


            document.getElementById("genome1").value = loadFile('toyblks.txt');

            document.getElementById("name1").value = '1';
            document.getElementById("name2").value = '2';
            document.getElementById("name3").value = '3';
            document.getElementById("name4").value = '4';

            document.getElementById("alias1").value = 'P1';
            document.getElementById("alias2").value = 'P2';
            document.getElementById("alias3").value = 'P3';
            document.getElementById("alias4").value = 'P4';

            document.getElementById("trees").value = '((1,2),(3,4))';

            document.getElementById("stages").value = '3';
            document.getElementById("target").value = '';
            document.getElementById("completion").value = '';

            showTarget(false);
        }

        function showTarget(show) {
            document.getElementById('targetDiv').style.display= show ? '' : 'none';
            document.getElementById('targetControl').style.display=show ? 'none' : '';
            document.getElementById('useTarget').value=show ? 1 : 0;
            return false;
        }
    </script>
</head>
<body bgcolor="#ffffff">
    <h1><a href="#">MGRA</a></h1>

    <p>Examples: <a href="#" onclick="setMam6(); return false;">mam6</a> <a href="#" onclick="setMam7(); return false;">mam7</a>
        <a href="#" onclick="setMurphy05(); return false;">murphy05</a> <a href="#" onclick="setToy05(); return false;">toy</a></p>

    <form method="post" action="http://localhost:8080/mgra" enctype="application/x-www-form-urlencoded" name="mgraForm">
    <table id="genomes">
    </table>

    <script>
        addGenome();addGenome();addGenome();
    </script>

    <p><a href="#" onclick="addGenome(); return false;">Add genome</a></p>

    <p>
        <strong>Known subtrees of the phylogenetic tree of the above genomes in Newick format</strong><br>
        If no trees are given, MGRA assumes that only terminal branches are known (as in MGR).
    </p>
    <textarea rows="6" cols="50" name="trees" id="trees"></textarea>

    <p>
        <strong>The number of stages to perform</strong>&nbsp;&nbsp;&nbsp;<input type='text' size='5' name='stages' id="stages" value="3"/><br>
        Higher values correspond to less reliable heuristics.
        The highest value is 4 and usually it still requires manual completion (see below).
        Smaller values require 'target' specification to produce ancestral reconstruction.
        It is not recommended to have stages higher than 3 if no complete phylogenetic tree is known.
    </p>

        <div id="targetControl">
            <a href="#" onclick="return showTarget(true);">Show Target and Completion fields</a>
        </div>

        <div id="targetDiv" style="display:none;">
    <p>
        <a href="#" onclick="return showTarget(false);">Remove Target and Completion fields</a>
    </p>
    <p>
        <strong>Target</strong>&nbsp;&nbsp;&nbsp;<input type='text' size='10' name='target' id="target"/><br>
        By default, MGRA reconstructs all ancestral genomes but it first has to complete transformation into an identity breakpoint graph.
        If 'target' is specified, MGRA focuses on reconstruction of the specified ancestral genome
        and can produce a partial reconstruction at any point (even if the transformation is not complete).
    </p>


    <p>
        Manual (human-assisted) completion of T-consistent transformation (the last stage of MGRA).
        Each row contains exactly five terms: `a b c d E' denoting a 2-break operating on the \vec{T}-consistent multicolor E,
        replacing the multiedges (a,b) and (c,d) with the multiedges (a,c) and (b,d).
        'oo' stands for a chromosome end.
        Manual completion can be derived from visual inspection of the breakpoint graph after MGRA Stage 3.
    </p>
    <textarea rows="6" cols="50" name="completion" id="completion"></textarea>
            </div>
    <input type="hidden" name="useTarget" id="useTarget" value="0"/>
    <p>
        <input type="submit" value="Submit form"/>
    </p>

    </form>
    </body>
</html>